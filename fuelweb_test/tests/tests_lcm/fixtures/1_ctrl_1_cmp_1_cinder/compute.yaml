roles:
  compute
tasks:
  ceilometer-compute:
    no_puppet_run: true
  ceph-compute:
    no_puppet_run: true
  cgroups: null
  clear_nodes_info:
    type: shell
  configure_default_route:
    check:
    - Anchor[l23network::init]
    - Anchor[l23network::l2::init]
    - File[/etc/network/interfaces.d]
    - File[/etc/network/interfaces]
    - Filebucket[puppet]
    - K_mod[8021q]
    - K_mod[bonding]
    - K_mod[bridge]
    - K_mod[openvswitch]
    - L2_port[enp0s6.103]
    - L3_clear_route[default]
    - L3_ifconfig[br-mesh]
    - L3_ifconfig[br-storage]
    - Package[bridge-utils]
    - Package[ethtool]
    - Package[ifenslave]
    - Package[iputils-arping]
    - Package[network-manager]
    - Package[openvswitch-common]
    - Package[openvswitch-datapath]
    - Package[vlan]
    - Schedule[daily]
    - Schedule[hourly]
    - Schedule[monthly]
    - Schedule[never]
    - Schedule[puppet]
    - Schedule[weekly]
    - Service[openvswitch-service]
    skip:
    - Disable_hotplug[global]
    - Enable_hotplug[global]
    - L23_stored_config[br-fw-admin]
    - L23_stored_config[br-mesh]
    - L23_stored_config[br-mgmt]
    - L23_stored_config[br-storage]
    - L23_stored_config[enp0s3]
    - L23_stored_config[enp0s5]
    - L23_stored_config[enp0s6.103]
    - L23_stored_config[enp0s6]
    - L23_stored_config[enp0s7]
    - L2_bridge[br-fw-admin]
    - L2_bridge[br-mesh]
    - L2_bridge[br-mgmt]
    - L2_bridge[br-storage]
    - L2_port[enp0s3]
    - L2_port[enp0s5]
    - L2_port[enp0s6]
    - L2_port[enp0s7]
    - L3_ifconfig[br-fw-admin]
    - L3_ifconfig[br-mgmt]
    - Notify[SDN]
  connectivity_tests: null
  copy_haproxy_keys:
    type: shell
  copy_keys:
    type: shell
  copy_keys_ceph:
    type: shell
  dns-client: null
  enable_nova_compute_service: null
  firewall: null
  fuel_pkgs: null
  globals: null
  hosts: null
  logging: null
  netconfig:
    check:
    - Anchor[l23network::init]
    - Anchor[l23network::l2::init]
    - File[/etc/network/interfaces.d]
    - File[/etc/network/interfaces]
    - File[/etc/sysctl.conf]
    - File[sysfs.d]
    - Filebucket[puppet]
    - K_mod[8021q]
    - K_mod[bonding]
    - K_mod[bridge]
    - K_mod[openvswitch]
    - L2_port[enp0s6.103]
    - L3_ifconfig[br-mesh]
    - L3_ifconfig[br-mgmt]
    - L3_ifconfig[br-storage]
    - Package[bridge-utils]
    - Package[ethtool]
    - Package[ifenslave]
    - Package[iputils-arping]
    - Package[irqbalance]
    - Package[network-manager]
    - Package[openvswitch-common]
    - Package[openvswitch-datapath]
    - Package[sysfsutils]
    - Package[vlan]
    - Ping_host[10.109.15.1]
    - Schedule[daily]
    - Schedule[hourly]
    - Schedule[monthly]
    - Schedule[never]
    - Schedule[puppet]
    - Schedule[weekly]
    - Service[openvswitch-service]
    - Sysctl[net.core.netdev_max_backlog]
    - Sysctl[net.ipv4.conf.all.arp_accept]
    - Sysctl[net.ipv4.conf.default.arp_accept]
    - Sysctl[net.ipv4.tcp_keepalive_intvl]
    - Sysctl[net.ipv4.tcp_keepalive_probes]
    - Sysctl[net.ipv4.tcp_keepalive_time]
    - Sysctl[net.ipv4.tcp_retries2]
    - Sysctl_runtime[net.core.netdev_max_backlog]
    - Sysctl_runtime[net.ipv4.conf.all.arp_accept]
    - Sysctl_runtime[net.ipv4.conf.default.arp_accept]
    - Sysctl_runtime[net.ipv4.tcp_keepalive_intvl]
    - Sysctl_runtime[net.ipv4.tcp_keepalive_probes]
    - Sysctl_runtime[net.ipv4.tcp_keepalive_time]
    - Sysctl_runtime[net.ipv4.tcp_retries2]
    skip:
    - Disable_hotplug[global]
    - Enable_hotplug[global]
    - Exec[wait-for-interfaces]
    - L23_stored_config[br-fw-admin]
    - L23_stored_config[br-mesh]
    - L23_stored_config[br-mgmt]
    - L23_stored_config[br-storage]
    - L23_stored_config[enp0s3]
    - L23_stored_config[enp0s5]
    - L23_stored_config[enp0s6.103]
    - L23_stored_config[enp0s6]
    - L23_stored_config[enp0s7]
    - L2_bridge[br-fw-admin]
    - L2_bridge[br-mesh]
    - L2_bridge[br-mgmt]
    - L2_bridge[br-storage]
    - L2_port[enp0s3]
    - L2_port[enp0s5]
    - L2_port[enp0s6]
    - L2_port[enp0s7]
    - L3_clear_route[default]
    - L3_ifconfig[br-fw-admin]
    - Notify[SDN]
    - Service[irqbalance]
    - Service[sysfsutils]
    - Sysfs_config_value[rps_cpus]
    - Sysfs_config_value[xps_cpus]
  ntp-client: null
  openstack-network-agents-l3: null
  openstack-network-agents-metadata: null
  openstack-network-agents-sriov: null
  openstack-network-common-config: null
  openstack-network-compute-nova: null
  openstack-network-end:
    type: shell
  openstack-network-plugins-l2: null
  openstack-network-start:
    type: shell
  override_configuration: null
  reboot_provisioned_nodes:
    type: shell
  reserved_ports: null
  rsync_core_puppet:
    type: shell
  setup_repositories: null
  ssl-add-trust-chain: null
  ssl-keys-saving: null
  sync_time:
    type: shell
  tools: null
  top-role-compute:
    check:
    - Anchor[nova-start]
    - Anchor[nova::config::begin]
    - Anchor[nova::config::end]
    - Anchor[nova::db::begin]
    - Anchor[nova::db::end]
    - Anchor[nova::dbsync::begin]
    - Anchor[nova::dbsync::end]
    - Anchor[nova::dbsync_api::begin]
    - Anchor[nova::dbsync_api::end]
    - Anchor[nova::install::begin]
    - Anchor[nova::install::end]
    - Anchor[nova::service::begin]
    - Anchor[nova::service::end]
    - Augeas[default-libvirt]
    - Augeas[libvirt-conf-uuid]
    - Augeas[libvirt-conf]
    - Augeas[qemu_hugepages]
    - Exec[networking-refresh]
    - Exec[refresh_apparmor]
    - File[/etc/default/cpufrequtils]
    - File[/tmp/compute-file]
    - File[/var/lib/nova/.ssh/config]
    - File_line[/etc/default/libvirtd libvirtd opts]
    - File_line[/etc/libvirt/libvirtd.conf auth_tcp]
    - File_line[/etc/libvirt/libvirtd.conf listen_tcp]
    - File_line[/etc/libvirt/libvirtd.conf listen_tls]
    - File_line[apparmor_libvirtd]
    - File_line[nbd_on_boot]
    - File_line[qemu_apparmor]
    - Filebucket[puppet]
    - Install_ssh_keys[nova_ssh_key_for_migration]
    - K_mod[nbd]
    - Nova_config[DEFAULT/allow_resize_to_same_host]
    - Nova_config[DEFAULT/auth_strategy]
    - Nova_config[DEFAULT/block_device_allocate_retries]
    - Nova_config[DEFAULT/block_device_allocate_retries_interval]
    - Nova_config[DEFAULT/compute_driver]
    - Nova_config[DEFAULT/compute_manager]
    - Nova_config[DEFAULT/config_drive_format]
    - Nova_config[DEFAULT/connection_type]
    - Nova_config[DEFAULT/debug]
    - Nova_config[DEFAULT/default_availability_zone]
    - Nova_config[DEFAULT/default_log_levels]
    - Nova_config[DEFAULT/default_schedule_zone]
    - Nova_config[DEFAULT/enabled_ssl_apis]
    - Nova_config[DEFAULT/fatal_deprecations]
    - Nova_config[DEFAULT/force_config_drive]
    - Nova_config[DEFAULT/force_raw_images]
    - Nova_config[DEFAULT/heal_instance_info_cache_interval]
    - Nova_config[DEFAULT/image_service]
    - Nova_config[DEFAULT/instance_format]
    - Nova_config[DEFAULT/instance_usage_audit]
    - Nova_config[DEFAULT/instance_usage_audit_period]
    - Nova_config[DEFAULT/instance_uuid_format]
    - Nova_config[DEFAULT/internal_service_availability_zone]
    - Nova_config[DEFAULT/log_config_append]
    - Nova_config[DEFAULT/log_date_format]
    - Nova_config[DEFAULT/log_dir]
    - Nova_config[DEFAULT/logging_context_format_string]
    - Nova_config[DEFAULT/logging_debug_format_suffix]
    - Nova_config[DEFAULT/logging_default_format_string]
    - Nova_config[DEFAULT/logging_exception_prefix]
    - Nova_config[DEFAULT/network_device_mtu]
    - Nova_config[DEFAULT/notification_driver]
    - Nova_config[DEFAULT/notification_topics]
    - Nova_config[DEFAULT/notify_api_faults]
    - Nova_config[DEFAULT/notify_on_state_change]
    - Nova_config[DEFAULT/os_region_name]
    - Nova_config[DEFAULT/publish_errors]
    - Nova_config[DEFAULT/rabbit_host]
    - Nova_config[DEFAULT/rabbit_password]
    - Nova_config[DEFAULT/rabbit_port]
    - Nova_config[DEFAULT/rabbit_userid]
    - Nova_config[DEFAULT/rabbit_virtual_host]
    - Nova_config[DEFAULT/remove_unused_base_images]
    - Nova_config[DEFAULT/remove_unused_original_minimum_age_seconds]
    - Nova_config[DEFAULT/report_interval]
    - Nova_config[DEFAULT/reserved_host_memory_mb]
    - Nova_config[DEFAULT/resume_guests_state_on_host_boot]
    - Nova_config[DEFAULT/rootwrap_config]
    - Nova_config[DEFAULT/rpc_backend]
    - Nova_config[DEFAULT/service_down_time]
    - Nova_config[DEFAULT/state_path]
    - Nova_config[DEFAULT/syslog_log_facility]
    - Nova_config[DEFAULT/use_cow_images]
    - Nova_config[DEFAULT/use_ipv6]
    - Nova_config[DEFAULT/use_stderr]
    - Nova_config[DEFAULT/use_syslog]
    - Nova_config[DEFAULT/use_syslog_rfc_format]
    - Nova_config[DEFAULT/vcpu_pin_set]
    - Nova_config[DEFAULT/verbose]
    - Nova_config[cinder/catalog_info]
    - Nova_config[cinder/os_region_name]
    - Nova_config[glance/api_servers]
    - Nova_config[keymgr/fixed_key]
    - Nova_config[keystone_authtoken/memcached_servers]
    - Nova_config[libvirt/block_migration_flag]
    - Nova_config[libvirt/cpu_mode]
    - Nova_config[libvirt/cpu_model]
    - Nova_config[libvirt/disk_cachemodes]
    - Nova_config[libvirt/hw_disk_discard]
    - Nova_config[libvirt/inject_key]
    - Nova_config[libvirt/inject_partition]
    - Nova_config[libvirt/inject_password]
    - Nova_config[libvirt/libvirt_inject_key]
    - Nova_config[libvirt/libvirt_inject_password]
    - Nova_config[libvirt/live_migration_flag]
    - Nova_config[libvirt/remove_unused_kernels]
    - Nova_config[libvirt/remove_unused_resized_minimum_age_seconds]
    - Nova_config[libvirt/virt_type]
    - Nova_config[oslo_concurrency/lock_path]
    - Nova_config[oslo_messaging_rabbit/amqp_durable_queues]
    - Nova_config[oslo_messaging_rabbit/heartbeat_rate]
    - Nova_config[oslo_messaging_rabbit/heartbeat_timeout_threshold]
    - Nova_config[oslo_messaging_rabbit/kombu_reconnect_delay]
    - Nova_config[oslo_messaging_rabbit/kombu_ssl_ca_certs]
    - Nova_config[oslo_messaging_rabbit/kombu_ssl_certfile]
    - Nova_config[oslo_messaging_rabbit/kombu_ssl_keyfile]
    - Nova_config[oslo_messaging_rabbit/kombu_ssl_version]
    - Nova_config[oslo_messaging_rabbit/rabbit_ha_queues]
    - Nova_config[oslo_messaging_rabbit/rabbit_hosts]
    - Nova_config[oslo_messaging_rabbit/rabbit_password]
    - Nova_config[oslo_messaging_rabbit/rabbit_use_ssl]
    - Nova_config[oslo_messaging_rabbit/rabbit_userid]
    - Nova_config[oslo_messaging_rabbit/rabbit_virtual_host]
    - Nova_config[ssl/ca_file]
    - Nova_config[ssl/cert_file]
    - Nova_config[ssl/key_file]
    - Nova_config[upgrade_levels/cells]
    - Nova_config[upgrade_levels/cert]
    - Nova_config[upgrade_levels/compute]
    - Nova_config[upgrade_levels/conductor]
    - Nova_config[upgrade_levels/console]
    - Nova_config[upgrade_levels/consoleauth]
    - Nova_config[upgrade_levels/intercell]
    - Nova_config[upgrade_levels/network]
    - Nova_config[upgrade_levels/scheduler]
    - Nova_config[vnc/enabled]
    - Nova_config[vnc/keymap]
    - Nova_config[vnc/novncproxy_base_url]
    - Nova_config[vnc/vncserver_listen]
    - Nova_config[vnc/vncserver_proxyclient_address]
    - Override_resources[nova_config]
    - Override_resources[nova_paste_api_ini]
    - Package[cpufrequtils]
    - Package[fping]
    - Package[libvirt]
    - Package[nova-common]
    - Package[nova-compute-qemu]
    - Package[nova-compute]
    - Package[openssh-client]
    - Package[python-nova]
    - Package[python-novaclient]
    - Package[qemu-kvm]
    - Schedule[daily]
    - Schedule[hourly]
    - Schedule[monthly]
    - Schedule[never]
    - Schedule[puppet]
    - Schedule[weekly]
    - Service[cpufrequtils]
    - Service[libvirt]
    - Service[qemu-kvm]
    skip:
    - Notify[Module openstack cannot notify service nova-compute on packages update]
    - Service[nova-compute]
  update_hosts: null
  upload_nodes_info:
    type: shell